# PRD (Product Requirements Document)

## 1. 문서 정보
- 제품명: PowerBuilder AS-IS 분석기 (가칭 `PB Analyzer`)
- 문서 버전: v0.1
- 작성일: 2026-02-13
- 대상 시스템: 레거시 UI(PowerBuilder) + 백엔드 연계(COBOL 포함) 환경

## 2. 배경 및 문제 정의
- 현재 프론트 프로그램(PowerBuilder)의 구조, 화면 흐름, 이벤트/함수 의존성, SQL 영향 범위가 문서화되어 있지 않음.
- 변경 시 영향 분석이 사람 경험에 의존해 품질/속도 리스크가 큼.
- 레거시 현대화, 유지보수, 장애 분석의 선행 단계로 객관적 AS-IS 분석 산출물이 필요함.

## 3. 제품 목표
- PowerBuilder 소스를 자동 분석해 화면/이벤트/함수/SQL/테이블 영향도를 구조화한다.
- 변경 영향 범위를 빠르게 확인할 수 있는 리포트를 제공한다.
- 반복 실행 가능한 추출-분석 파이프라인을 구축한다.

## 4. 비목표 (Out of Scope)
- COBOL 내부 로직의 정밀 역공학.
- 런타임 동적 로직 100% 복원.
- 코드 자동 변환(마이그레이션 자동 코드 생성).

## 5. 사용자 및 이해관계자
- 유지보수 개발자: 화면/함수/테이블 영향 분석 조회
- 아키텍트/PM: 시스템 구조 파악, 개선 우선순위 결정
- QA: 변경 테스트 범위 도출

## 6. 핵심 사용 시나리오
1. 특정 화면(`Window`)을 변경하기 전, 연관 이벤트/함수/테이블 목록을 조회한다.
2. 특정 테이블 변경 시 영향 받는 화면과 함수를 역추적한다.
3. 미사용(추정) 객체를 찾아 정리 후보를 발굴한다.

## 7. 기능 요구사항 (Functional Requirements)
- FR-01: PowerBuilder 객체 인벤토리 추출(Window/UserObject/Menu/DataWindow/Function/Event)
- FR-02: 함수/이벤트 호출 관계(`calls`, `triggers_event`) 추출
- FR-03: 화면 전환/호출 관계(`opens`) 추출
- FR-04: DataWindow SQL 추출 및 테이블 매핑
- FR-05: Embedded SQL 추출 및 CRUD 단위 정규화
- FR-06: 분석 결과를 IR(중간 모델) 저장소에 적재
- FR-07: 기본 리포트 생성
  - 화면 인벤토리
  - 이벤트-함수 맵
  - SQL/테이블 영향도
  - 화면 간 이동/호출 그래프
  - 미사용 객체 후보
- FR-08: CLI 기반 일괄 실행(`extract -> analyze -> report`)
- FR-09: 실행/오류 로그 및 실패 원인 리포트 제공

## 8. 비기능 요구사항 (Non-Functional Requirements)
- NFR-01: 재현성: 동일 입력 소스에 대해 동일 결과 보장
- NFR-02: 성능: 기준 데이터셋(전체 프로젝트) 30분 내 분석 완료(목표)
- NFR-03: 확장성: 규칙 추가 시 기존 파이프라인 최소 변경
- NFR-04: 관측성: 단계별 처리 건수/오류율 측정 가능
- NFR-05: 신뢰성: 부분 실패 시 실패 객체 식별 및 재시도 가능

## 9. 범위
### 포함
- PowerBuilder 정적 분석(소스 추출물 기반)
- 객체/관계/SQL/영향도 리포트

### 제외(초기 릴리스)
- 실시간 IDE 플러그인
- 런타임 트레이싱 에이전트

## 10. 성공 지표 (KPI)
- KPI-01: 전체 화면의 80% 이상에서 진입 이벤트/주요 호출/사용 DW/주요 테이블 자동 추출
- KPI-02: 골든셋 기준 정밀도 85%+, 재현율 75%+
- KPI-03: 특정 화면 변경 영향 분석 소요 시간 5분 이내

## 11. 제약 및 가정
- 소스 추출은 ORCA Script 기반으로 표준화 가능하다고 가정
- 프로젝트별 코딩 컨벤션 편차 존재(예외 규칙 필요)
- 네트워크/런타임 정보 없이 정적 분석만으로 일부 한계 존재

## 12. 릴리스 계획 (MVP 기준)
- S1: 범위/추출/IR 스키마 확정
- S2: 파싱/관계/SQL 추출 엔진
- S3: CLI + 핵심 리포트 3종
- S4: 그래프/정확도 보정
- S5: 회귀 자동화/운영화

## 13. 수용 기준 (Acceptance Criteria)
- AC-01: 지정된 입력 소스에서 분석 파이프라인이 중단 없이 실행된다.
- AC-02: 핵심 리포트 3종(인벤토리, 이벤트-함수, 테이블 영향도)이 생성된다.
- AC-03: 골든셋에서 KPI 기준을 충족한다.
- AC-04: 실행 결과와 오류가 로그로 추적 가능하다.

## 14. 주요 리스크
- R-01: 난해한 PowerScript 문법/동적 호출로 인한 미탐
- R-02: SQL 문자열 조립 패턴으로 인한 테이블 식별 누락
- R-03: 대형 프로젝트에서 성능 저하

## 15. 리스크 대응
- 예외 패턴 카탈로그 운영 및 규칙 점진 확장
- 골든셋 기반 정기 회귀 테스트
- 단계별 프로파일링 및 캐시/병렬 처리 적용
